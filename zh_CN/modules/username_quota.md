# 用户名配额限制

从 4.4.25 版本开始，新增了用户名配额限制模块，用以限制单个 MQTT 用户名的最大会话数。

当某个用户名超过配额后，新的会话将被拒绝连接，并返回相应的 CONNACK 返回码：“0x97 配额已超”（MQTT 5.0）或 “0x03 服务不可用”（MQTT 3.1.1）。

## 添加模块

1. 在 Dashboard 的左侧导航菜单中点击**模块**。
2. 在页面上点击**添加模块**按钮。
3. 在模块选择页面的**认证**标签下，找到**用户名配额限制**，然后点击**选择**。
4. 为用户名配额限制模块配置以下选项：
   - **用户名最大会话数**：定义每个用户名允许的最大 MQTT 会话数。请注意，如果 MQTT 客户端使用持久会话登录，即使客户端断开连接，会话也会继续保留在服务器上，直到会话过期并被清除。
   - **用户名白名单**：您可以点击右侧的**添加**按钮添加用户名条目。白名单中的用户名不受会话数限制。例如，连接到集群的 MQTT 桥接客户端应绕过配额限制，您可以将 MQTT 桥接使用的用户名添加到白名单中。

5. 点击**添加**完成设置。

![user-quota-create](./assets/user-quota-create-zh.png)

## 使用示例

1. 在模块页面，找到您已添加的**用户名配额限制**模块。点击右侧的**管理**。

2. 在详情页面，您可以看到 EMQX 集群中的当前用户名及其使用的会话数。点击会话数旁边的**查看**按钮，可以查看当前用户名的会话列表。

   ![user-quota-usage](./assets/user-quota-usage-zh.png)
